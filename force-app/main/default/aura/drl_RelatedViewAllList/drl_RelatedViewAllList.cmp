
<aura:component
  implements="lightning:isUrlAddressable"
  controller="drl_Controller"
>
  <!-- attributes -->
  <aura:attribute name="data" type="Object" />
  <aura:attribute name="columnData" type="List" />
  <aura:attribute name="recordCount" type="String" />
  <aura:attribute name="buttonData" type="List" />
  <aura:attribute name="isFirstLoad" type="Boolean" default="True" />
  <aura:attribute name="relatedRecordId" type="Id" />
  <aura:attribute name="relatedObjectName" type="String" />
  <aura:attribute name="relatedListTitle" type="String" />
  <aura:attribute name="relatedListConfig" type="String" />
  <aura:attribute name="backURL" type="String" />
  <aura:attribute name="rowId" type="Id" />
  <aura:attribute name="recordError" type="String" access="private" />
  <aura:attribute name="isModalOpen" type="boolean" default="false"/>

  <!-- lightning navigation service-->
  <lightning:navigation aura:id="navService" />

  <!-- handlers-->
  <aura:handler name="render" value="{!this}" action="{!c.onRender}" />
  <aura:handler
    name="init"
    value="{!this}"
    action="{!c.onPageReferenceChange}"
  />

  <!--UI Design Starts Here-->
  <div class="header">
    <div
      class="slds-page-header--object-home slds-page-header_joined slds-page-header_bleed slds-page-header slds-shrink-none test-headerRegion forceListViewManagerHeader pageHeader"
    >
      <div class="slds-grid" data-aura-rendered-by="2598:0">
        <div class="slds-col slds-has-flexi-truncate firstHeaderRow">
          <div class="slds-media slds-no-space slds-grow">
            <div
              class="slds-media__body slds-align-middle"
              data-aura-rendered-by="2603:0"
            >
              <a href="{!v.backURL}">Go Back to Record</a>
              <h1
                title="{!v.relatedListTitle}"
                class="slds-page-header__title listViewTitle slds-truncate"
                >{!v.relatedListTitle}</h1
              >
            </div>
          </div>
        </div>
        <!--List View Buttons-->
        <div
          class="slds-col slds-no-flex slds-grid slds-align-top slds-p-bottom--xx-small test-lvmForceActionsContainer"
        >
          <lightning:buttonIcon
            iconName="utility:refresh"
            alternativeText="Refresh List"
            title="Refresh List"
            onclick="{!c.refreshData}"
            class="refreshButton"
          ></lightning:buttonIcon>
          <aura:iteration items="{!v.buttonData}" var="button">
            <button
              class="slds-button slds-button_neutral refreshButton"
              data-component="{!button.componentName}"
              onclick="{!c.listButtonClicked}"
              >{!button.buttonLabel}</button
            >
          </aura:iteration>
        </div>
      </div>
    </div>
    <!--Data Table-->
    <div class="slds-grid listDisplays safari-workaround-anchor dataTable">
      <lightning:datatable
        keyField="id"
        data="{!v.data}"
        columns="{!v.columnData}"
        hideCheckboxColumn="true"
        onrowaction="{!c.handleRowAction}"
      />
    </div>
  </div>

  <aura:if isTrue="{!v.isModalOpen}">
             
            <!-- Modal/Popup Box starts here-->
            <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container">
                    <!-- Modal/Popup Box Header Starts here-->
                    <header class="slds-modal__header">
                        <lightning:buttonIcon iconName="utility:close"
                                              onclick="{!c.closeModal}"
                                              alternativeText="close"
                                              variant="bare-inverse"
                                              class="slds-modal__close"/>
                        <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">Delete Record?</h2>
                    </header>
                    <!--Modal/Popup Box Body Starts here-->
                    <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                        Are you sure you want to delete this item?
                    </div>
                    <!--Modal/Popup Box Footer Starts here-->
                    <footer class="slds-modal__footer">
                        <lightning:button variant="neutral"
                                          label="Cancel"
                                          title="Cancel"
                                          onclick="{!c.closeModal}"/>
                        <lightning:button variant="brand"
                                          label="Delete"
                                          title="Delete"
                                          onclick="{!c.deleteClick}"/>
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </aura:if>
  <!--Body Added to dynamically add/remove components-->
  {!v.body}
</aura:component>
